"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const auth_middleware_1 = require("../middlewares/auth.middleware");
const errorHandler_middleware_1 = require("../middlewares/errorHandler.middleware");
const rateLimit_middleware_1 = require("../middlewares/rateLimit.middleware");
const auditLogs_controller_1 = require("../controllers/auditLogs.controller");
const router = (0, express_1.Router)();
router.use(auth_middleware_1.authenticateJWT);
router.post('/audit-logs', rateLimit_middleware_1.writeRateLimiter, (0, errorHandler_middleware_1.asyncHandler)(auditLogs_controller_1.createAuditLogHandler));
router.get('/audit-logs', rateLimit_middleware_1.readRateLimiter, (0, errorHandler_middleware_1.asyncHandler)(auditLogs_controller_1.getAuditLogsHandler));
router.get('/audit-logs/stats', rateLimit_middleware_1.readRateLimiter, (0, errorHandler_middleware_1.asyncHandler)(auditLogs_controller_1.getAuditLogStatsHandler));
router.get('/audit-logs/search', rateLimit_middleware_1.readRateLimiter, (0, errorHandler_middleware_1.asyncHandler)(auditLogs_controller_1.searchAuditLogsHandler));
router.get('/audit-logs/history/:entity_type/:entity_id', rateLimit_middleware_1.readRateLimiter, (0, errorHandler_middleware_1.asyncHandler)(auditLogs_controller_1.getEntityHistoryHandler));
router.get('/audit-logs/:id', rateLimit_middleware_1.readRateLimiter, (0, errorHandler_middleware_1.asyncHandler)(auditLogs_controller_1.getAuditLogByIdHandler));
exports.default = router;
